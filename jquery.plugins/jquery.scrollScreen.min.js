// jQuery scrollView V0.8.2 : Viewport scroll and screen vertical helper - @molokoloco 2013 - Copyleft
// One view for each screen that user need to scroll to get to the bottom of the HTML view
// Live fiddle : http://jsfiddle.net/molokoloco/XK3t5/
// Github : https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.scrollScreen.js
// Infos : ...

(function(b,n){var p=b(n),r=b(document),z=b("body"),j="html,body,document",q=b(),k="",x=!1;b(j).each(function(){var c=parseInt(b(this).scrollTop(),10);b(this).scrollTop(c+1);if(p.scrollTop()==c+1)return j=this.nodeName.toLowerCase(),!1});var q=b(j),l=function(){return n.location.hash||""},s=function(){return parseInt(q.scrollTop()||p.scrollTop(),10)},t=function(c){x=!0;var b=360+0.42*Math.abs(c-s());2222<b&&(b=0);q.stop(!0,!1).animate({scrollTop:c},{duration:b,easing:"easeOutCubic",complete:function(){var c=
k;c&&l()!=c&&(n.location.hash=c);k="";x=!1}})};b.easing.jswing=b.easing.swing;b.extend(b.easing,{def:"easeOutQuad",swing:function(c,m,d,h,e){return b.easing[b.easing.def](c,m,d,h,e)},easeInQuad:function(c,b,d,h,e){return h*(b/=e)*b+d},easeOutCubic:function(c,b,d,h,e){return h*((b=b/e-1)*b*b+1)+d}});b.fn.scrollToMe=function(c){return this.each(function(){c&&(k=c);t(parseInt(b(this).offset().top,10))})};b.fn.scrollScreen=function(c){if(!0==z.data("scrollScreen"))return this;z.data("scrollScreen",!0);
c=b.extend(!0,{},b.fn.scrollScreen.defaults,"object"==typeof c&&c);var m=b(this),d=b('<div class="'+c.scrollScreen+'">1</div>').appendTo(m),h=b('<div class="'+c.scrollScreenZone+'" title="Pour naviguer d\'\u00e9cran en \u00e9cran..."></div>').appendTo(m),e=null,f=null,g=p.height(),u=r.height(),v=1+Math.floor(r.height()/g),j=-Math.floor(d.height()-d.height()/3),q=g-d.height(),k=function(){c.debug&&console.log("mouseIsMoveViewsClear()");e&&clearTimeout(y);x?e=setTimeout(k,2500):(e=null,d.removeClass("current"),
h.attr("title",""),w(s()))},m=function(a){c.debug&&console.log("mouseIsOutViews(event)",a);e&&clearTimeout(y);e=setTimeout(k,2500)},A=function(a){c.debug&&console.log("moveViews(ascPos)",a);a=a||s();a+=j;a=Math.max(a,0);a=Math.min(a,q);var b=1+Math.floor(v*(a/g));d.css({top:a}).text(b);if(c.checkHash&&l()!="#screen_"+b&&(a="#screen_"+b)&&l()!=a)n.location.hash=a},y=function(a){c.debug&&console.log("mouseIsMoveViews(event)",a.clientY);e?(clearTimeout(e),e=null):d.addClass("current");A(a.clientY)},
w=function(a){c.debug&&console.log("setCurrentViewport(scrollTop)",a);a=((a||s())+g)/u;a*=g;A(a)},C=function(a){c.debug&&console.log("viewportClick(event)",a);t(u*((a.clientY+j)/g));return!1},D=function(){c.debug&&console.log("viewportDbClick()");t(1);return!1};c.debug&&console.log("createViewport()");1>v||(h.on("click touchend",C).on("dblclick",D).on("mousemove",y).on("mouseout",m),w());var E=function(){c.debug&&console.log("scrollRefreshEvent()");f=null;d.removeClass("current")},F=function(a){c.debug&&
console.log("resizeRefreshEvent()");g=p.height();u=r.height();v=Math.ceil(r.height()/g);w();c.checkHash&&(f=setTimeout(function(a){f=null;B(a)},1E3,a||l()))};p.on("scroll",function(){f&&clearTimeout(f);f=setTimeout(E,600);w();d.addClass("current")}).on("resize",function(){f&&clearTimeout(f);f=setTimeout(F,360,l())});var B=function(a){if(a=a||l())if(a=a.split("screen_"),0<parseInt(a[1],10)){c.debug&&console.log("checkHash() auto init target",a[1]);a=a[1];c.debug&&console.log("moveToViewport(view)",
a);var b=0,b=a==v?u:a*g;t(b)}};c.checkHash&&B();return this};b.fn.scrollScreen.defaults={debug:"console"in n&&!1,checkHash:!1,scrollScreenZone:"scrollScreenZone",scrollScreen:"scrollScreen"}})(jQuery,window);
