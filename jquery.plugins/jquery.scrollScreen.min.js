// jQuery scrollView V0.8.2 : Viewport scroll and screen vertical helper - @molokoloco 2013 - Copyleft
// One view for each screen that user need to scroll to get to the bottom of the HTML view
// Live fiddle : http://jsfiddle.net/molokoloco/XK3t5/
// Github : https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.scrollScreen.js
// Infos : ...

(function(b,n,x){var p=b(n),s=b(x),A=b("body"),k="html,body,document",q=b(),l="",y=!1;b(k).each(function(){var c=parseInt(b(this).scrollTop(),10);b(this).scrollTop(c+1);if(p.scrollTop()==c+1)return k=this.nodeName.toLowerCase(),!1});var q=b(k),j=function(){return n.location.hash||""},t=function(){return parseInt(q.scrollTop()||p.scrollTop(),10)},u=function(c){y=!0;var b=360+0.42*Math.abs(c-t());2222<b&&(b=0);q.stop(!0,!1).animate({scrollTop:c},{duration:b,easing:"easeOutCubic",complete:function(){var c=
l;c&&j()!=c&&(n.location.hash=c);l="";y=!1}})};b.easing.jswing=b.easing.swing;b.extend(b.easing,{def:"easeOutQuad",swing:function(c,m,d,h,e){return b.easing[b.easing.def](c,m,d,h,e)},easeInQuad:function(c,b,d,h,e){return h*(b/=e)*b+d},easeOutCubic:function(c,b,d,h,e){return h*((b=b/e-1)*b*b+1)+d}});b.fn.scrollToMe=function(c){return this.each(function(){c&&(l=c);u(parseInt(b(this).offset().top,10))})};b.fn.scrollScreen=function(c){if(!0==A.data("scrollScreen"))return this;A.data("scrollScreen",!0);
c=b.extend(!0,{},b.fn.scrollScreen.defaults,"object"==typeof c&&c);var m=b(this),d=b('<div class="'+c.scrollScreen+'">1</div>').appendTo(m),h=b('<div class="'+c.scrollScreenZone+'" title="Pour naviguer d\'\u00e9cran en \u00e9cran..."></div>').appendTo(m),e=null,g=null,f=p.height(),r=s.height(),v=1+Math.floor(s.height()/f),k=-Math.floor(d.height()-d.height()/3),q=f-d.height(),l=function(){c.debug&&console.log("mouseIsMoveViewsClear()");e&&clearTimeout(z);y?e=setTimeout(l,2500):(e=null,d.removeClass("current"),
h.attr("title",""),w(t()))},m=function(a){c.debug&&console.log("mouseIsOutViews(event)",a);e&&clearTimeout(z);e=setTimeout(l,2500)},B=function(a){c.debug&&console.log("moveViews(ascPos)",a);a=a||t();a+=k;a=Math.max(a,0);a=Math.min(a,q);var b=1+Math.floor(v*(a/f));d.css({top:a}).text(b);if(c.checkHash&&j()!="#screen_"+b&&(a="#screen_"+b)&&j()!=a)n.location.hash=a},z=function(a){c.debug&&console.log("mouseIsMoveViews(event)",a.clientY);e?(clearTimeout(e),e=null):d.addClass("current");B(a.clientY)},
w=function(a){c.debug&&console.log("setCurrentViewport(scrollTop)",a);a=((a||t())+f)/r;a*=f;B(a)},x=function(a){c.debug&&console.log("viewportClick(event)",a);var b=0,b=10>a.clientY?0:a.clientY>f-10?r:r*((a.clientY+k)/f);u(b);return!1},D=function(){c.debug&&console.log("viewportDbClick()");u(1);return!1};c.debug&&console.log("createViewport()");1>v||(h.on("click touchend",x).on("dblclick",D).on("mousemove",z).on("mouseout",m),w());var E=function(){c.debug&&console.log("scrollRefreshEvent()");g=null;
d.removeClass("current")},F=function(a){c.debug&&console.log("resizeRefreshEvent()");f=p.height();r=s.height();v=Math.ceil(s.height()/f);w();c.checkHash&&(g=setTimeout(function(a){g=null;C(a)},1E3,a||j()))};p.on("scroll",function(){g&&clearTimeout(g);g=setTimeout(E,600);w();d.addClass("current")}).on("resize",function(){g&&clearTimeout(g);g=setTimeout(F,360,j())});var C=function(a){c.debug&&console.log("checkHash(hash)",a,"getHash()",j());if(a=a||j())if(a=a.split("screen_"),1<parseInt(a[1],10)){a=
a[1];c.debug&&console.log("moveToViewport(view)",a);var b=0,b=a==v?r:a*f;u(b)}};c.checkHash&&C();return this};b.fn.scrollScreen.defaults={debug:"console"in n&&!0,checkHash:!1,scrollScreenZone:"scrollScreenZone",scrollScreen:"scrollScreen"}})(jQuery,window,document);
