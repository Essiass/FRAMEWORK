// jQuery colonize V0.8.1 : In-between titles Multicols paragraphes
// Molokoloco 2013 - Copyleft
// Live fiddle : http://jsfiddle.net/molokoloco/Ra288/
// Github : https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonize.js
//          https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonize.css
// Infos :  http://b2bweb.fr/molokoloco/jquery-colonize-plugin-in-between-titles-multicols-paragraphes-with-css3/

(function(c){c.fn.colonize=function(a){a=c.extend(!0,{},c.fn.colonize.defaults,"object"==typeof a&&a);var e=null,p='<div class="'+a.css+'"/>',f=0,h=0,k=0,l=0,m=0,n=function(){for(var d=c(this),b=d.next(),g=[],e=!1,f=0;b;)b.is(a.take)?(g.push(b),b=b.next()):(b.is(a.chapters)||(e=!0),b=null);if(1<g.length||g.length&&g[0].outerHeight()>m){for(var b=c(p),j=0,h=g.length;j<h;j++)f+=g[j].height()*k,b.append(g[j].detach()),f>=a.maxHeight&&(b.insertAfter(d),d=b,f=0,b=c(p));b.insertAfter(d);e&&c.proxy(n,b.next())()}else e&&
(l++,3>l&&d.next()&&c.proxy(n,d.next())())};return this.each(function(){e=c(this);h=f=e.width();k=1;m=l=0;var d=e.find(a.css);if(d.length){var b="";d.each(function(){var a=c(this);b+=a.html();a.remove()});e.append(b)}d=c("<p>A</p>").appendTo(e);m=d.outerHeight();d.remove();a.colWidth&&(a.colCount=Math.max(1,Math.floor(f/a.colWidth)));h=(f-2*a.marge*a.colCount)/a.colCount;k=f/h;e.find(a.chapters).each(n)})};c.fn.colonize.defaults={marge:10,colWidth:null,colCount:null,chapters:"h1,h2,h3,h4,h5,h6",take:"p",
css:"multiplecolumns",maxHeight:Math.max(100,c(window).height()-60)}})(window.jQuery);
