/* =============================================================
 * jQuery colonizr V0.9.0 - Molokoloco 2013 - Copyleft
 * "In-between titles Multicols paragraphes" (Bootstrap-like plugin)
 * Live fiddle : http://jsfiddle.net/molokoloco/Ra288/
 * Github : https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonizr.js
            https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonizr.min.js
 *          https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonizr.css
 *  Infos : http://www.b2bweb.fr/molokoloco/jquery-colonize-plugin-in-between-titles-multicols-paragraphes-with-css3/
 * ============================================================== */

!function(b){function e(a,g){this.options=b.extend(!0,{},b.fn.colonizr.defaults,"object"==typeof g&&g||{});this.$container=b(a);this.wrapper='<div class="'+this.options.css+'"/>';this.cWidth;this.colHeightRatio;this.intentNextP;this.lineHeight;this.maxHeight;this.refresh()}e.prototype={constructor:e,colsExtractor:function(a,g){for(var d=b(g),c=d.next(),f=[],e=!1,h=0;c;)c.is(this.options.take)?(f.push(c),c=c.next()):(c.is(this.options.chapters)||(e=!0),c=null);if(1<f.length||f.length&&f[0].outerHeight()>
this.lineHeight){c=b(this.wrapper);a=0;for(var j=f.length;a<j;a++)h+=f[a].height()*this.colHeightRatio,c.append(f[a].detach()),h>=this.maxHeight&&f[a+1]&&(c.insertAfter(d),d=c,h=0,c=b(this.wrapper));c.insertAfter(d);e&&this.colsExtractor(0,c.next())}else e&&(this.intentNextP++,3>this.intentNextP&&d.next()&&this.colsExtractor(0,d.next()))},refresh:function(){this.cWidth=this.$container.width();this.colHeightRatio=1;this.lineHeight=this.intentNextP=0;this.maxHeight=this.options.maxHeight;var a=this.cWidth;
1>this.options.maxHeight&&(this.maxHeight=Math.max(80,b(window).height()-60));a=this.$container.find("."+this.options.css);a.length&&a.each(function(){var a=b(this);b(a.html()).insertBefore(a);a.remove()});a=b("<p>A</p>").appendTo(this.$container);this.lineHeight=a.outerHeight();a.remove();this.options.colWidth&&(this.options.colCount=Math.max(1,Math.floor(this.cWidth/this.options.colWidth)));a=(this.cWidth-2*this.options.marge*this.options.colCount)/this.options.colCount;this.colHeightRatio=this.cWidth/
a;this.$container.find(this.options.chapters).each(b.proxy(this.colsExtractor,this))}};var j=b.fn.colonizr;b.fn.colonizr=function(a){return this.each(function(){var g=b(this),d=g.data("colonizr");d||g.data("colonizr",d=new e(this,a));if("string"==typeof a)d[a]()})};b.fn.colonizr.Constructor=e;b.fn.colonizr.defaults={marge:10,colWidth:null,colCount:null,chapters:"h1,h2,h3,h4,h5,h6",take:"p",css:"multiplecolumns",maxHeight:null};b.fn.colonizr.noConflict=function(){b.fn.colonizr=j;return this};b(window).on("load",
function(){b('[data-colonizr="true"]').each(function(){var a=b(this);a.colonizr(a.data())})})}(window.jQuery);
